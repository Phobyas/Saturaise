/* CRITICAL: LCP Optimization - First slide must be immediately visible */
.section-slideshow[data-section-loaded="false"]:not(.preview-mode)
  .slideshow__slide.is-selected,
.no-js .section-slideshow .slideshow__slide.is-selected,
.section-slideshow .slideshow__slide:first-child,
.section-slideshow .slide:first-child {
  opacity: 1 !important;
  width: 100%;
  display: block !important;
  visibility: visible !important;
  position: relative !important;
  z-index: 2 !important;
  /* Override any animations for immediate visibility */
  animation: none !important;
  transition: none !important;
  transform: none !important;
}

/* CRITICAL: Prevent layout shifts with explicit dimensions */
.section-slideshow .slideshow {
  border: 0 !important;
  width: 100%;
  max-width: 1280px;
  margin: 0 auto;
  contain: layout; /* Improve paint performance */
  /* Set explicit aspect ratio to prevent layout shift */
  aspect-ratio: 1920/800;
  position: relative;
  overflow: hidden;
}

@media (min-width: 1920px) {
  .section-slideshow .slideshow {
    max-width: 1600px;
  }
}

/* CRITICAL: Mobile aspect ratio */
@media (max-width: 767px) {
  .section-slideshow .slideshow {
    aspect-ratio: 4/5; /* Better for mobile */
  }
}

/* CRITICAL: All slides positioned absolutely except first */
.section-slideshow .slideshow__slide {
  width: 100%;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  opacity: 0;
  visibility: hidden;
}

/* CRITICAL: First slide image optimization - immediate visibility */
.section-slideshow .slideshow__slide:first-child,
.section-slideshow .slide:first-child {
  opacity: 1 !important;
  width: 100%;
  display: block !important;
  z-index: 2 !important;
  position: relative !important;
  visibility: visible !important;
  /* Disable all animations for LCP element */
  animation: none !important;
  transition: none !important;
  transform: none !important;
}

/* CRITICAL: First slide image must render immediately */
.section-slideshow .slideshow__slide:first-child img,
.section-slideshow .slideshow__slide:first-child .slideshow__slide-image img,
.section-slideshow .slide:first-child img {
  opacity: 1 !important;
  visibility: visible !important;
  transform: none !important;
  transition: none !important;
  animation: none !important;
  /* Ensure proper sizing for layout stability */
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  display: block;
  /* Explicit aspect ratio for immediate layout */
  aspect-ratio: 1920/800;
}

@media (max-width: 767px) {
  .section-slideshow .slideshow__slide:first-child img,
  .section-slideshow .slide:first-child img {
    aspect-ratio: 4/5;
  }
}

.slideshow__slide-image .onboard {
  display: flex;
  align-items: center;
}

.slideshow__slide-image {
  position: relative;
  width: 100%;
  height: 100%;
}

.slideshow__slide-image:before {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  content: "";
  background: var(--section-overlay-color);
  pointer-events: none;
  z-index: 1;
}

/* Force aspect ratio to prevent layout shift */
.slideshow__slide-image picture {
  display: block;
  width: 100%;
  height: 100%;
}

/* CRITICAL: Force image dimensions to prevent layout shifts */
.slideshow__slide-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
  display: block;
  transform: translateZ(0); /* Force GPU acceleration */
}

/* CRITICAL: Animation optimizations - NO animations for first slide */
@media screen and (prefers-reduced-motion: no-preference) {
  .animation-text--active
    [data-section-loaded]:has(.slide-animate):not(.preview-mode)
    .slideshow__slide:not(:first-child)
    .slide-animate {
    opacity: 0;
    transition: opacity 0.5s ease-in, transform 2s ease;
    will-change: opacity, transform;
  }

  .animation-text--active
    [data-section-loaded]:has(.slide-animate):not(.preview-mode)
    .slideshow__slide:not(:first-child)
    .slide-animate.delay--1 {
    transition-delay: 0.5s;
  }

  .animation-text--active
    [data-section-loaded]:has(.slide-animate):not(.preview-mode)
    .slideshow__slide:not(:first-child)
    .slide-animate.delay--2 {
    transition-delay: 0.65s;
  }

  .animation-text--active
    [data-section-loaded]:has(.slide-animate):not(.preview-mode)
    .slideshow__slide:not(:first-child)
    .slide-animate.delay--3 {
    transition-delay: 0.75s;
  }

  /* First slide animations should be disabled */
  .animation-text--active
    [data-section-loaded]:has(.slide-animate):not(.preview-mode)
    .slideshow__slide:first-child
    .slide-animate {
    opacity: 1 !important;
    visibility: visible !important;
    transform: none !important;
    animation: none !important;
    transition: none !important;
  }

  .animation-text--active
    [data-section-loaded="true"]:has(.slide-animate):not(.preview-mode)
    .slideshow__slide.is-selected:not(:first-child)
    .slide-animate,
  .no-js
    .animation-text--active
    [data-section-loaded="false"]:has(.slide-animate):not(.preview-mode)
    .slideshow__slide.is-selected:not(:first-child)
    .slide-animate,
  .animation-text--active
    .section--reloaded
    [data-section-loaded="false"]:has(.slide-animate):not(.preview-mode)
    .slideshow__slide.is-selected:not(:first-child)
    .slide-animate {
    opacity: 1;
    visibility: visible;
    transform: translate(0);
  }
}

/* CRITICAL: Only apply transitions to non-first slides for LCP */
@media screen and (prefers-reduced-motion: no-preference) {
  .section-slideshow:not(.preview-mode) .slideshow__slide:not(:first-child) {
    opacity: 0 !important;
    transition: opacity 1s ease !important;
  }

  .section-slideshow:not(.preview-mode)
    .slideshow__slide.is-selected:not(:first-child) {
    opacity: 1 !important;
    z-index: 1;
  }

  /* CRITICAL: No transition for first slide to improve LCP */
  .section-slideshow:not(.preview-mode) .slideshow__slide:first-child {
    transition: none !important;
    opacity: 1 !important;
    visibility: visible !important;
    animation: none !important;
    transform: none !important;
  }
}

@media (min-width: 1024px) {
  .section-slideshow .slideshow.flickity__section .flickity-page-dots {
    text-align: right;
    bottom: 15px;
    right: 15px;
  }
}

.section-slideshow .slideshow__caption {
  position: absolute;
  width: fit-content;
  z-index: 2;
}

@media screen and (max-width: 740px) {
  .section-slideshow .slideshow__caption {
    width: 100%;
    word-break: break-word;
  }
}

.section-slideshow .slideshow__caption p {
  line-height: initial;
}

.slideshow__caption .slideshow__caption-wrapper {
  padding: 30px;
  background: var(--background);
  display: flex;
  flex-direction: column;
  -ms-align-content: center;
  align-content: center;
  align-items: center;
  row-gap: 15px;
  padding: 30px;
}

.slideshow__caption.hide_caption_background .slideshow__caption-wrapper {
  background: transparent;
}

.slideshow__caption .slideshow__caption-wrapper.a-left {
  align-items: flex-start;
}

.slideshow__caption .slideshow__caption-wrapper.a-right {
  align-items: flex-end;
}

.slideshow__caption h2.slideshow__title,
.slideshow__caption p,
.slideshow__caption p a {
  color: var(--text-color);
  margin-bottom: 0;
}

.slideshow__caption .btn-border-link span {
  font-size: var(--font-size-reset);
}

.slideshow__caption .btn-border-link:before,
.slideshow__caption .btn-border-link:after {
  background: var(--text-color);
}

.slideshow__caption .btn-border-link span:before,
.slideshow__caption .btn-border-link span:after {
  background: var(--text-color);
}

.slide__buttons {
  display: flex;
  column-gap: 10px;
  padding: 10px 0;
}

.section-slideshow .slideshow__btn-wrapper {
  display: inline-block;
  white-space: nowrap;
}

.section-slideshow .slideshow__btn-wrapper a {
  display: inline-block;
  -webkit-transition: background 0.3s ease, color 0.3s ease;
  -moz-transition: background 0.3s ease, color 0.3s ease;
  -o-transition: background 0.3s ease, color 0.3s ease;
  transition: background 0.3s ease, color 0.3s ease;
}

@media (max-width: 767px) {
  .section-slideshow .slideshow__caption-wrapper {
    width: 100%;
  }

  .section-slideshow .flickity__section .flickity-button {
    width: 30px;
    height: 30px;
  }

  .slideshow__caption.caption--below__image h2.slideshow__title,
  .slideshow__caption.caption--below__image p,
  .slideshow__caption.caption--below__image .rte a,
  .slideshow__caption.caption--below__image .btn-border-link span {
    color: var(--color-body-text);
  }

  .slideshow__caption.caption--below__image,
  .slideshow__caption.caption--below__image .slideshow__caption-wrapper {
    background: var(--color-body);
  }

  .slideshow__caption.caption--below__image .btn-border-link:before,
  .slideshow__caption.caption--below__image .btn-border-link:after,
  .slideshow__caption.caption--below__image .btn-border-link span:before,
  .slideshow__caption.caption--below__image .btn-border-link span:after {
    background: var(--color-body-text);
  }

  .slideshow__caption.caption--below__image .slideshow__caption-wrapper.a-left,
  .slideshow__caption.caption--below__image
    .slideshow__caption-wrapper.a-right {
    align-items: center !important;
    text-align: center !important;
  }
}

.section-slideshow .main-carousel.v-center .flickity-slider {
  display: flex;
  align-items: center;
}

.section-slideshow .flickity-button.previous {
  right: unset;
  left: 10px;
  top: 50%;
}

.section-slideshow .flickity-button.next {
  right: 10px;
  left: unset;
  top: 50%;
}

/* ---- Slideshow section heights ---- */
.section-slideshow .slideshow.is-fixed_height .slideshow__slide .box-ratio img {
  object-fit: cover;
  object-position: center;
  position: absolute;
  top: 50%;
  left: 50%;
  -webkit-transform: translate(-50%, -50%);
  -ms-transform: translate(-50%, -50%);
  -moz-transform: translate(-50%, -50%);
  -o-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);
}

/* fixed height */
.section-slideshow .slideshow.is-fixed_height .slideshow__slide-image,
.section-slideshow
  .slideshow.is-fixed_height
  .slideshow__slide-image
  .box-ratio
  img {
  height: var(--desktop-section-height);
  contain: strict; /* Optimize paint */
}

.section-slideshow
  .slideshow.is-fixed_height
  .slideshow__slide-image
  .box-ratio {
  padding-bottom: var(--desktop-section-height) !important;
  position: relative;
}

.section-slideshow .slideshow.is-fixed_height .onboard {
  min-height: var(--desktop-section-height);
}

@media screen and (max-width: 768px) {
  .section-slideshow .slideshow.is-fixed_height .slideshow__slide-image,
  .section-slideshow
    .slideshow.is-fixed_height
    .slideshow__slide-image
    .box-ratio
    img {
    height: var(--mobile-section-height) !important;
  }

  .section-slideshow
    .slideshow.is-fixed_height
    .slideshow__slide-image
    .box-ratio {
    padding-bottom: var(--mobile-section-height) !important;
  }

  .section-slideshow .slideshow.is-fixed_height .onboard {
    min-height: var(--mobile-section-height);
    height: var(--mobile-section-height);
  }
}

.section-slideshow .flickity-page-dots {
  display: none;
}

/* CRITICAL: Set explicit dimensions for slideshow to prevent layout shifts */
.section-slideshow .slideshow.is-fixed_height {
  height: var(--desktop-section-height);
}

@media screen and (max-width: 768px) {
  .section-slideshow .slideshow.is-fixed_height {
    height: var(--mobile-section-height);
  }
}

/* CRITICAL: Optimize navigation buttons to reduce CLS */
.section-slideshow .flickity-button {
  opacity: 0.7;
  background-color: rgba(255, 255, 255, 0.7);
  will-change: opacity;
  transition: opacity 0.3s ease;
}

.section-slideshow .flickity-button:hover {
  opacity: 1;
}

/* CRITICAL: Ensure images maintain aspect ratio while loading */
.slideshow img[width][height] {
  aspect-ratio: attr(width) / attr(height);
  border-radius: 12px;
}

/* CRITICAL: Additional LCP optimizations */
/* Prioritize first slide image loading */
.section-slideshow .slideshow__slide:first-child img {
  content-visibility: auto;
  contain-intrinsic-size: 1920px 800px;
}

@media (max-width: 767px) {
  .section-slideshow .slideshow__slide:first-child img {
    contain-intrinsic-size: 800px 1000px;
  }
}

/* Remove any lazy loading from first slide */
.section-slideshow .slideshow__slide:first-child img[loading="lazy"] {
  loading: eager !important;
}

.section-slideshow .slideshow__slide:first-child img.lazyload,
.section-slideshow .slideshow__slide:first-child img.lazy {
  opacity: 1 !important;
  visibility: visible !important;
}

/* Optimize font loading for captions */
.slideshow__caption {
  font-display: swap;
}

/* CRITICAL: Prevent any transforms on first slide that could delay rendering */
.section-slideshow .slideshow__slide:first-child,
.section-slideshow .slideshow__slide:first-child .slideshow__slide-image,
.section-slideshow .slideshow__slide:first-child img,
.section-slideshow .slide:first-child,
.section-slideshow .slide:first-child .slide-image,
.section-slideshow .slide:first-child img {
  transform: none !important;
  transition: none !important;
  animation: none !important;
  opacity: 1 !important;
  visibility: visible !important;
}

/* Ensure proper sizing for responsive images */
.section-slideshow picture {
  display: block;
  width: 100%;
  height: 100%;
}

.section-slideshow picture img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center;
}

/* CRITICAL: Hide navigation until JS loads to prevent layout shift */
.section-slideshow .nav-arrow,
.section-slideshow .nav-dots,
.section-slideshow .flickity-button {
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
}

.section-slideshow.js-loaded .nav-arrow,
.section-slideshow.js-loaded .nav-dots,
.section-slideshow.js-loaded .flickity-button {
  opacity: 1;
  pointer-events: auto;
}

/* Optimize for single slide scenarios */
.section-slideshow .single-slide .nav-arrow,
.section-slideshow .single-slide .nav-dots {
  display: none !important;
}

/* CRITICAL: Additional Forge theme specific optimizations */
/* Override Forge animation classes for first slide */
.section-slideshow .slideshow__slide:first-child.animation--active,
.section-slideshow .slide:first-child.animation--active {
  animation: none !important;
  opacity: 1 !important;
  visibility: visible !important;
  transform: none !important;
}

/* Disable text animations on first slide captions */
.section-slideshow .slideshow__slide:first-child .animation-text--active,
.section-slideshow .slide:first-child .animation-text--active {
  animation: none !important;
  transition: none !important;
  opacity: 1 !important;
  visibility: visible !important;
  transform: none !important;
}

/* Ensure slideshow container has proper dimensions immediately */
.section-slideshow {
  min-height: 400px;
  width: 100%;
}

@media (max-width: 767px) {
  .section-slideshow {
    min-height: 320px;
  }
}

/* Force visibility of first slide content immediately */
.section-slideshow .slideshow__slide:first-child *,
.section-slideshow .slide:first-child * {
  opacity: 1 !important;
  visibility: visible !important;
}

/* Optimize paint performance for first slide */
.section-slideshow .slideshow__slide:first-child {
  contain: layout style paint;
  will-change: auto;
}

/* Additional mobile optimizations */
@media (max-width: 767px) {
  .section-slideshow .slideshow__slide:first-child img,
  .section-slideshow .slide:first-child img {
    /* Ensure mobile images load with proper dimensions */
    width: 100% !important;
    height: auto !important;
    max-width: 100% !important;
  }
}
